(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{602:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});h(a(70));var s=h(a(11)),r=h(a(10)),n=h(a(14)),l=h(a(12)),o=h(a(13)),i=h(a(0)),c=h(a(49)),p=a(23),d=a(8),m=a(42),u=a(324),g=a(46);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,r.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.getPosts=function(){if(!a.props.page_name)return null;var e=a.state.posts&&Array.isArray(a.state.posts)?a.state.posts.length:0,t=e?a.state.posts[e-1].post_id:0,s=a.state.nextPage-1;a.state.isMerchantPage?a.props.getMerchantPosts(a.props.merchantId,t,a.props.city,s):"campaignpage"===a.props.page_name?a.props.getCampaignPosts(a.props.deal_id,t,a.props.city,a.props.page_name):"userpage"===a.props.page_name?a.props.getUserPosts(a.props.user_id,t,a.props.city,a.props.page_name):"tagpage"===a.props.page_name&&a.props.getTagPosts(a.props.tag_name,t,a.props.city,a.props.page_name,a.props.lat,a.props.lon,s)},a.scrollLoad=function(e){var t=document.getElementById("posts-holder").getBoundingClientRect().top,s=document.getElementById("posts-holder").offsetHeight,r=s+t;window.pageYOffset>=r-200&&a.state.load_more_posts&&!a.props.showLoader&&(a.getPosts(),r=(s=document.getElementById("posts-holder").offsetHeight)+t)},a.startInfininteLoading=function(){(0,g.sendEvent)("web_"+window.pageName,"click","view_more_posts",(0,d.getEventExtras)()),a.scrollLoad(),(0,d.registerListener)("scroll",(0,d.debounce)(a.scrollLoad,250).bind(a)),a.setState({showViewMoreButton:!1})},a.state={nextPage:1,load_more_posts:!0,posts:a.props.posts?a.props.posts:[],hideMerchant:!1,showViewMoreButton:!0,isMerchantPage:a.props.page_name.includes("voucherdetailpage")||a.props.page_name.includes("merchantpage"),total_count:a.props.posts_count},a}return(0,o.default)(t,e),(0,n.default)(t,[{key:"componentWillReceiveProps",value:function(e){!e.showLoader&&e.postsResult.length<1&&this.setState({load_more_posts:!1}),e.postsResult&&!e.showLoader&&this.setState({posts:this.state.posts.concat(e.postsResult),nextPage:this.state.nextPage+1})}},{key:"createMarkUp",value:function(e){return{__html:e}}},{key:"componentDidMount",value:function(){this.setState({hideMerchant:this.props.hide_merchant||!1}),("userpage"===this.props.page_name||"campaignpage"===this.props.page_name||"tagpage"===this.props.page_name||this.props.page_name.includes("merchantpage"))&&this.getPosts(),this.state.isMerchantPage||(0,d.registerListener)("scroll",(0,d.debounce)(this.scrollLoad,250).bind(this))}},{key:"render",value:function(){var e=this,t=function(e){var t=e.deal.city||"New Delhi";return(0,m.get_merchant_url)(e.deal.merchant.merchant_id,e.deal.merchant_name,e.deal.locality,t,e.deal.category_id)};return i.default.createElement("div",{id:"posts-holder",className:"posts-holder"},i.default.createElement(_,null,this.state.posts.map((function(a,s){return i.default.createElement("div",{className:"post",key:s},i.default.createElement("div",{className:"user-details"},i.default.createElement("a",{onClick:function(){(0,g.sendEvent)("web_"+window.pageName,"click","customer_experience_user")},href:a.user_url},i.default.createElement("div",{className:"user-image-container"},i.default.createElement("img",{loading:"lazy",src:a.author_profile.profile_pic?(0,d.resizeMagicUrl)(a.author_profile.profile_pic,"small"):d.config.resourcepath+"images/profile.svg",alt:a.author_profile.name+"profile pic",className:"user-image"})),i.default.createElement("div",{className:"user-details-text"},i.default.createElement("div",{className:"user"},i.default.createElement("span",{className:"user-name"},a.author_profile.name)),i.default.createElement("h6",null,a.author_profile.vanity),i.default.createElement("h6",null,a.create_time)))),!!(a.rating&&a.rating>0)&&i.default.createElement("div",{className:"review"},i.default.createElement("div",{className:"rating",style:a.rating>4.5?{backgroundColor:"#008a3b"}:a.rating>4?{backgroundColor:"#00ae28"}:a.rating>3?{backgroundColor:"#8bcc00"}:a.rating>2.5?{backgroundColor:"#ffc20f"}:a.rating>1.5?{backgroundColor:"#ff882e"}:{backgroundColor:"#ee5350"}},i.default.createElement("img",{alt:"star",src:d.config.resourcepath+"images/merchant/star-white.svg",className:"star"}),i.default.createElement("span",{className:"rating-value"},a.rating.toFixed(1))),i.default.createElement("p",{className:"rating-text"}," Rating : "),i.default.createElement("p",{className:"user-review",dangerouslySetInnerHTML:e.createMarkUp(a.review)})),i.default.createElement("div",{className:"post-image-container"},a.image&&((0,d.isMagicUrl)(a.image)||(0,d.isMagicpinCdn)(a.image)||a.image.includes("d22y893cekuu8h.cloudfront.net"))&&i.default.createElement("div",null,a.fb_post_id&&i.default.createElement("a",{"data-type":"post-fb",className:"view-on-fb",target:"_blank",href:a.fb_link},i.default.createElement("img",{alt:"fb",src:d.config.resourcepath+"images/view-on-fb.svg"})),i.default.createElement("a",{onClick:function(){(0,g.sendEvent)("web_"+window.pageName,"click","customer_experience")},"data-type":"post-image",href:a.feed_pic_link},!!a.video&&i.default.createElement("img",{alt:"play icon",src:d.config.resourcepath+"images/play.svg",className:"play-icon"}),i.default.createElement("img",{className:"post-image",loading:"lazy",src:(0,d.resizeMagicUrl)(a.image,"large"),alt:a.author_profile.name+"@"+a.deal.merchant_name+","+a.deal.locality+","+a.deal.city+"photos",title:a.author_profile.name+"@"+a.deal.merchant_name+","+a.deal.locality+","+a.deal.city})))),i.default.createElement("div",null,a.deal&&!e.state.hideMerchant&&t(a)&&i.default.createElement("a",{onClick:function(){(0,g.sendEvent)("web_"+window.pageName,"click","customer_experience_merchant")},className:"merchant",href:t(a)},i.default.createElement("div",{className:"merchant-logo-container"},i.default.createElement("img",{loading:"lazy",src:a.deal.merchant.profile_pic?(0,d.resizeMagicUrl)(a.deal.merchant.profile_pic,"small"):"https://lh3.googleusercontent.com/h3a-3-5lPFdfRhS1JEvCl8GeOtKIbfnVEJt8hC1JXDhxK4BPn9sJetnWXh4ZQZ81O2_dUbBzpfs2Ub5RLGfe-L78o0Vdd5Ez-2llXz5-",alt:"merchant profile",title:"",className:"merchant-logo"})),i.default.createElement("div",{className:"merchant-details"},i.default.createElement("h4",{className:"merchant-name"},a.deal.merchant.name),i.default.createElement("h5",null,a.deal.merchant.address)))),i.default.createElement("p",{className:"likes"},a.likes>0&&i.default.createElement("span",null," ",a.likes," likes "),a.comments>0&&i.default.createElement("span",null," . ",a.comments," comments ")),a.caption&&"None"!=a.caption&&i.default.createElement("p",{className:"post-text",dangerouslySetInnerHTML:e.createMarkUp(a.caption)}))}))),i.default.createElement("div",{className:"view-more-holder"},!!this.props.showLoader&&i.default.createElement(c.default,null)),this.state.isMerchantPage&&this.state.showViewMoreButton&&!(0,d.isEmpty)(this.state.posts)&&this.state.total_count>this.state.posts.length&&i.default.createElement("div",{className:"see-more-vouchers-btn",onClick:this.startInfininteLoading},"View More"))}}]),t}(i.default.Component),_=function(e){var t=e.children;return i.default.createElement("div",{id:"posts-holder",className:"posts-holder"},t)};t.default=(0,p.connect)((function(e){return{postsResult:e.post.postsResult,showLoader:e.post.showLoader}}),{getMerchantPosts:u.getMerchantPosts,getCampaignPosts:u.getCampaignPosts,getUserPosts:u.getUserPosts,getTagPosts:u.getTagPosts})(f)}}]);